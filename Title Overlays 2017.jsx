//////////////////////////////////////////////////////////////////////////////////////////////////////////// GLOBAL VARIABLES AND FUNCTIONS ////////////////////////////////////////////////////////////////////////////////////////////////////////////// Creates variable shortcut for app.projectvar myProj = app.project;// Creating variables for Comp foldersvar MasterComp = getProjectID("Master Intro Template");// This function searches the entire Project folder and returns the relevant items index ID (can be folder, footage, item, etc)function getProjectID(str) {    for (var i = 1; i <= myProj.numItems; i ++) {        if (myProj.item(i).name === str) {            return myProj.item(i);            }    }}// function getProjectID(str) { // Instantiating panel windowvar myPalette = buildUI(this);if (myPalette != null && myPalette instanceof Window) {	myPalette.show();}// This function creates the main CompCreator dockable window to hold all of the potential actions (Create, Update, Render)function buildUI (thisObject) {    if (thisObject instanceof Panel) {        var myPalette = thisObject;    } else {         var myPalette = new Window ("palette", scriptTitle, undefined, {resizeable: true});    }    if (myPalette != null) {                var res =         "Group { \            orientation: 'column', \            alignment: ['fill', 'top'], \            alignChildren: ['fill', 'top'], \                createPanel: Panel { \                    text: 'Create comps', \                    alignChildren: ['fill', 'top'], \                    createAllBtn: Button {text:'Create ALL comps', preferredSize: [75, 50]}, \                    }, \            }";                    myPalette.grp = myPalette.add(res);        myPalette.layout.layout(true);        myPalette.layout.resize();                // Create ALL comps button and onClick action        myPalette.grp.createPanel.createAllBtn.onClick = function () {                createAllComps(myPalette);        }           myPalette.onResizing = myPalette.onResize = function () {this.layout.resize();}        } // if (myPalette != null) {    return myPalette;} //function buildUI () function createAllComps(palObj) {             // Selecting and reading CSV    var spreadsheet = File.openDialog("Please select .csv file");    var readOK = spreadsheet.open("r");        // Create undogroup for quick ctrl+Z use        app.beginUndoGroup("Bulk comp creation");    // If CSV is read OK, begin creating comps    if (readOK) {                        // This loops through CSV, first creating an array and from that, an object for each row.        var spreadsheetContents = spreadsheet.read();        var itemsArray = spreadsheetContents.split(/\n|\r/);        var itemsObject = new Object();        for (var i=1; i < itemsArray.length; i++) {             itemsArray[i] = itemsArray[i].split(",");            itemsObject[i] = {                code: itemsArray[i][0],                 title: itemsArray[i][1],                 programme: itemsArray[i][2],                instructor: itemsArray[i][3]                } //itemsObject[i] = {        } // for (var i=0; i < itemsArray.length; i++) {                           // Cycle through itemsObject to create comp            for (var i in itemsObject){                            var vidCode = itemsObject[i].code;                var newInstructor = itemsObject[i].instructor;                var newProg = itemsObject[i].programme;                var vidTitle = itemsObject[i].title;                // Duplicating intro template                    var newIntroComp = MasterComp.duplicate();                    // Renaming duplicated intro                    newIntroComp.name = vidCode;                    // Updating instructor line                     newIntroComp.layer(1).property("Source Text").setValue(newInstructor);                    // Updating programme line                     newIntroComp.layer(2).property("Source Text").setValue(newProg);                        // Updating title line                    newIntroComp.layer(3).property("Source Text").setValue(vidTitle);               } // for (var i in itemsObject)                            alert("Comp creation complete");                        } else {            alert("Error opening CSV file");        } // if (readOK)    app.endUndoGroup();            } // function createAllComps(palObj) {